<div class="main-content">
  <div class="report-toolbar">
    <span class="report-title"> <i class="k-icon k-i-check"></i> {{title}}</span>
    <div class="right-section ms-auto">
      <button kendoButton icon="arrow-chevron-left" routerLink="/projects">Back</button>
    </div>
  </div>

  <kendo-card width="100%" class="mt-2">

    <kendo-card-body>

      <kendo-stepper #stepper [steps]="steps" stepType="full" [(currentStep)]="currentStepIndex" [linear]="isLinear">
      </kendo-stepper>

      <div class="container">

        <div class="alert alert-danger alert-dismissible fade show mt-2" *ngIf="errorMessage" role="alert">
          <span>{{errorMessage}}</span>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <form class="k-form" [formGroup]="projectForm" (ngSubmit)="submit()">

          <app-project-main-information *ngIf="currentStepIndex === 0"
            [formGroup]="getFromGroup('mainInformation')"></app-project-main-information>
          <app-project-additional-information *ngIf="currentStepIndex === 1"
            [formGroup]="getFromGroup('additionalInformation')" [isEditMode]="isEditMode"></app-project-additional-information>

          <span class="k-form-separator mt-5"></span>
          <div class="step-navigation-container d-flex justify-content-between">
            <span class="step-indicator align-self-center">Step {{ currentStepIndex + 1 }} of {{steps.length}}</span>
            <div class="button-container mt-2 d-flex">
              <button kendoButton icon="delete" themeColor="error" class="ms-2" (click)="openDeleteConfirm()" title="Project can be deleted because it has no related information"
                *ngIf="!(disableDeleteButton$ | async)">Delete</button>
              <button kendoButton icon="arrow-chevron-left" class="ms-2" (click)="prev()"
                *ngIf="currentStepIndex !== 0">Previous</button>
              <button kendoButton icon="arrow-chevron-right" themeColor="primary" class="ms-2" (click)="next()"
                *ngIf="currentStepIndex < 1">Next</button>
              <button kendoButton icon="save" themeColor="secondary" class="ms-2" (click)="submit()"
                *ngIf="currentStepIndex > 0">Submit</button>
            </div>
          </div>

        </form>

        <kendo-dialog title="Please confirm" *ngIf="discardChangesDialogOpened$ | async" (close)="closeDiscardDialog()"
          [minWidth]="250" [width]="400">
          <p class="m-3 text-center">
            There are unsaved changes. Are you sure you want to discard them?
          </p>
          <kendo-dialog-actions>
            <button kendoButton (click)="closeDiscardDialog()">No</button>
            <button kendoButton (click)="discardChanges()" themeColor="primary">Yes</button>
          </kendo-dialog-actions>
        </kendo-dialog>

        <kendo-dialog title="Please confirm" *ngIf="showDeleteProjectDialog && project" (close)="closeDeleteProjectDialog()"
          [minWidth]="250" [width]="400">
          <p class="m-3 text-center">
            Are you sure you want to delete the project "{{project.Code}} - {{project.Name}}"?
          </p>
          <kendo-dialog-actions>
            <button kendoButton (click)="closeDeleteProjectDialog()">No</button>
            <button kendoButton (click)="deleteProject()" themeColor="primary">Yes</button>
          </kendo-dialog-actions>
        </kendo-dialog>

      </div>

    </kendo-card-body>
  </kendo-card>
</div>